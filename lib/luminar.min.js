/*
 * Copyright (c) 2025 Muhammad Raj (github.com/iamajraj)
 * Licensed under the MIT License.
 * See the LICENSE file for details.
 */
class Luminar{constructor(e,t={}){this.img=e,this.options={zoomLevel:3,lensSize:150,lensShape:"circle",showLensBorder:!1,...t},this.init()}init(){this.createLens(),this.setupEvents()}createLens(){this.lens=document.createElement("div"),this.lens.style.cssText=`
    position: absolute;
    width: ${this.options.lensSize}px;
    height: ${this.options.lensSize}px;
    border: ${this.options.showLensBorder?"2px solid #fff":"none"};
    border-radius: ${"circle"===this.options.lensShape?"50%":"0"};
    cursor: none;
    pointer-events: none;
    background-repeat: no-repeat;
    overflow: hidden;
    display: none;
    box-shadow: none;
`,this.magnifier=document.createElement("div"),this.magnifier.style.cssText=`
    width: ${this.options.lensSize}px;
    height: ${this.options.lensSize}px;
    background-image: url("${this.img.src}");
    background-repeat: no-repeat;
`,this.lens.appendChild(this.magnifier),this.container=document.createElement("div"),this.container.style.position="relative",this.container.style.display="inline-block",this.img.parentNode.insertBefore(this.container,this.img),this.container.appendChild(this.img),this.container.appendChild(this.lens)}setupEvents(){this.container.addEventListener("mousemove",this.handleMove.bind(this)),this.container.addEventListener("mouseenter",this.handleEnter.bind(this)),this.container.addEventListener("mouseleave",this.handleLeave.bind(this));let e=!1;this.container.addEventListener("touchstart",t=>{t.preventDefault(),e=!0,this.handleEnter(),this.handleTouchMove(t)}),this.container.addEventListener("touchmove",t=>{t.preventDefault(),e&&this.handleTouchMove(t)}),this.container.addEventListener("touchend",()=>{e=!1,this.handleLeave()})}handleEnter(){this.lens.style.display="block",this.magnifier.style.backgroundSize=`${this.img.width*this.options.zoomLevel}px 
     ${this.img.height*this.options.zoomLevel}px`}handleLeave(){this.lens.style.display="none"}handleMove(e){this.updatePosition(e.clientX,e.clientY)}handleTouchMove(e){let t=e.touches[0];this.updatePosition(t.clientX,t.clientY)}updatePosition(e,t){let i=this.img.getBoundingClientRect(),n=e-i.left,s=t-i.top,o=n-this.options.lensSize/2,h=s-this.options.lensSize/2,l=i.width-this.options.lensSize,a=i.height-this.options.lensSize;this.lens.style.left=`${Math.min(Math.max(o,0),l)}px`,this.lens.style.top=`${Math.min(Math.max(h,0),a)}px`;let r=n*this.options.zoomLevel-this.options.lensSize/2,d=s*this.options.zoomLevel-this.options.lensSize/2;this.magnifier.style.backgroundPosition=`-${r}px -${d}px`}destroy(){let e=this.container.parentElement,t=this.img;e&&e.append(t),this.container.remove()}}